{% extends "layout.html" %}
{% block body %}
  <div class="uk-grid" data-uk-grid-margin>
      <div class="uk-width-1-1">
        <h4 class="uk-heading-large">Datasets</h4>
        <h4> Total {{ stats|length }} datasets </h4>
        {% set limit = 9 %}
        {% set skip = 9 %}
        <select id="page">
          <option selected="true" disabled="disabled">Choose Datasets</option>    
          <script> 
            for(var i={{skip+limit}};i<={{stats|length}};i+={{limit}}){
                document.write("<option value = "+ i +" >"+Math.round(i/{{limit}} , 1)+"</option>");
            }
            $('#pagination').change(function() {
              var skip = $(this).val();
              console.log(skip);
              window.location="/";
            });
          </script>
        </select> 
        <div "datasetStatus"></div> 
      </div>
  </div>
  
  <div class="uk-block">
  <!-- Group in 3 items-->
  {% for stat_chunk in stat_chunks %}
    <div class="uk-grid">
      {% for stat in stat_chunk %}
      <div class="uk-width-medium-1-3">
        <div class="uk-panel uk-panel-box">
          <div class="uk-panel-badge uk-badge">Number of records: {{ stat.numberOfRecords }}</div>
          <h3 class="uk-panel-title">{{ stat.dataset }}</h3>
            <div>
             <a href="{{ url_for('records', dataset=stat.dataset, skip=0, limit=10) }}"><button class="uk-button uk-button-primary">Records</button></a> 
            <a href="{{ url_for('record_stats_page', dataset=stat.dataset) }}"><button class="uk-button uk-button-primary">Stats</button></a>
            <a href="#"><button class="uk-button uk-button-primary" data-uk-modal="{ target: '#editDataset{{ stat.dataset }}'}">View Details</button></a>
          </div>
          <br>
          <div>
            <a href="#"><button class="uk-button uk-button-danger" data-uk-modal="{target:'#deleteDataset'}">Delete</button></a>
            <a href="{{ url_for('add_record_page', dataset=stat.dataset) }}"><button class="uk-button uk-button-success">Add Record</button></a>
          </div>            
        </div>
      </div>
      {% endfor %}
    </div>
  {% endfor %}

  <!-- divison of modal to delete a dataset -->
  {% for stat in stats%}
    <div id="deleteDataset" class="uk-modal">
      <div class="uk-modal-dialog">
          <a class="uk-modal-close uk-close"></a>
          <form class="uk-form">
            <legend>Are you sure?</legend>
            <button onclick='client.removeDataset("{{ stat.dataset }}")' class="uk-button uk-button-success" >Yes</button>
            <button class="uk-button uk-button-danger">No</button>
          </form>
      </div>
    </div>
  {% endfor %}

    

    <!-- division of modal to edit a dataset-->
  <div>
    {% for stat_chunk in stat_chunks %}
      {% for stat in stat_chunk %}
        <div id="editDataset{{ stat.dataset }}" class="uk-modal">
          <div class="uk-modal-dialog">
            <a class="uk-modal-close uk-close"></a>
            <form class="uk-form uk-form-stacked">
            <legend>Edit Record {{stat.dataset}}</legend>
            <div class="uk-form-row">
              <label class="uk-form-label" for="ID">Dataset Name</label>
              <input id="ID" type="text" placeholder="ID" value="{{stat.dataset}}" autofocus disabled>
            </div>
            <div class="uk-form-row">
            {% for field_obj in datasetFields %}
              {% if stat.dataset == field_obj.name %}
                {% for field_data in field_obj.fields %}
                  <div class="uk-grid-row">
                      <div id="fieldName">
                        <label class="uk-form-label" for="ID">Field Name</label>
                        <input id="ID" type="text" value="{{field_data.name}}" autofocus disabled>
                      </div>
                      <div id="fieldType">
                        <label class="uk-form-label" for="ID">Field Type</label>
                        <input id="ID" type="text" value="{{field_data.type}}" autofocus disabled>
                      </div>
                  </div>
                {% endfor %}
              {% endif %}
            {% endfor %}
            </div>
            <div class="uk-form-row">
              <button id="add-label-btn" class="uk-button uk-button-primary" onclick="console.log('moooo')">Submit</button>
            </div>
          </form>
          </div>
        </div>
      {% endfor %}
    {% endfor %}
    <select id="pagination">
      <option selected="true" disabled="disabled">Choose Datasets</option>    
      <script> 
        for(var i={{skip+limit}};i<={{stats|length}};i+={{limit}}){
            document.write("<option value = "+ i +" >"+Math.round(i/{{limit}} , 1)+"</option>");
        }
        $('#pagination').change(function() {
          var skip = $(this).val();
          console.log(skip);
          window.location="/";
        });
      </script>
    </select>
  </div>
{% endblock %}
